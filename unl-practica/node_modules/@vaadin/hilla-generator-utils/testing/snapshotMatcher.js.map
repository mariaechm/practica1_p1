{"mappings":"AAAA,SAAS,UAAU,mCAAoC;AACvD,SAAS,+BAAgC;AAEzC,MAAM,OAAO,QAAQ,KAAK,MAAM,EAAE;AAClC,MAAM,eAAe,KAAK,SAAS,KAAK,IAAI,KAAK,SAAS,WAAW;AAWrE,eAAe,SAAS,gBAAgBA,MAAuBC,OAA6B;AAC1F,OAAM;EACJ,KAAK,UAAU;EACf;;EAEA,eAAe,gBAA8BC,cAAsBC,eAAsC;GACvG,MAAM,MAAM,MAAM,KAAK,MAAM,SAAS;GACtC,MAAM,cAAc,IAAI,KAAK,aAAa,aAAa,GAAG;GAC1D,MAAM,eAAe,cAAc,YAAY;AAE/C,OAAI,cAAc;AAChB,UAAM,UAAU,cAAc,KAAK,OAAO;GAC3C,OAAM;IACL,IAAI;AACJ,QAAI;AACF,gBAAW,MAAM,SAAS,cAAc,OAAO;IAChD,QAAO;AACN,WAAM,IAAI,OACP,+BAA+B,YAAY,UAAU,CAAC;IAE1D;AAED,SAAK,OAAO,MAAM,KAAK,SAAS;GACjC;EACF;CACF;AACF","names":["chai: Chai.ChaiStatic","utils: Chai.ChaiUtils","snapshotName: string","importMetaUrl: string"],"sources":["/opt/agent/work/1af72d8adc613024/hilla/packages/ts/generator-utils/src/testing/snapshotMatcher.ts"],"sourcesContent":["import { readFile, writeFile } from 'node:fs/promises';\nimport { fileURLToPath } from 'node:url';\n\nconst argv = process.argv.slice(2);\nconst shouldUpdate = argv.includes('-u') || argv.includes('--update');\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  export namespace Chai {\n    interface Assertion {\n      toMatchSnapshot(snapshotName: string, importMetaUrl: string): Promise<void>;\n    }\n  }\n}\n\nexport default function snapshotMatcher(chai: Chai.ChaiStatic, utils: Chai.ChaiUtils): void {\n  utils.addMethod(\n    chai.Assertion.prototype,\n    'toMatchSnapshot',\n    // eslint-disable-next-line prefer-arrow-callback\n    async function toMatchSnapshot(this: object, snapshotName: string, importMetaUrl: string): Promise<void> {\n      const obj = utils.flag(this, 'object');\n      const snapshotURL = new URL(`./fixtures/${snapshotName}`, importMetaUrl);\n      const snapshotPath = fileURLToPath(snapshotURL);\n\n      if (shouldUpdate) {\n        await writeFile(snapshotPath, obj, 'utf8');\n      } else {\n        let snapshot;\n        try {\n          snapshot = await readFile(snapshotPath, 'utf8');\n        } catch {\n          throw new Error(\n            `Snapshot does not exist yet: ${snapshotURL.toString()}.\\nConsider running tests with --update flag.`,\n          );\n        }\n\n        chai.assert.equal(obj, snapshot);\n      }\n    },\n  );\n}\n"],"version":3}