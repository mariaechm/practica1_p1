{"mappings":"AACA,OAAO,+FAAgG;AACvG,OAAO,yEAA0E;AACjF,OAAO,wFAAyF;AAChG,OAAO,4EAA6E;AACpF,OAAO,oBAA0C;AAEjD,eAAe,MAAM,gBAAgB;CACnC,AAASA;CACT,AAASC;CAET,YAAYC,UAAkBC,OAAe;AAC3C,OAAKF,cAAc,IAAI,YAAY,EAAE,WAAW,KAAM,GAAE,mBAAmB,SAAS;AACpF,OAAKD,SAAS;CACf;CAED,UAAsB;AACpB,OAAKA,OAAO,OAAO,OAAO,aAAa,KAAKC,YAAY,EAAE;EAE1D,MAAM,EAAE,SAAS,SAAS,OAAO,GAAG,IAAI,kBAAkB,IAAI,YAAY,EAAE,WAAW,MAAO;EAC9F,MAAM,gBAAgB,QAAQ,MAAM,IAClC,MAAM,qBAAqB,0BAA0B,MAAM,EAC3D,gBACD;EAED,MAAM,cAAc,4BAA4B,SAAS;AACzD,UAAQ,QAAQ,IAAI,YAAY;EAEhC,MAAM,cAAc,GAAG,QAAQ,wBAC7B,WACA,GAAG,QAAQ,8BACT,CACE,GAAG,QAAQ,0BACT,aACA,WACA,WACA,GAAG,QAAQ,oBAAoB,eAAe,WAAW,CACvD,GAAG,QAAQ,8BACT,CACE,GAAG,QAAQ,yBACT,GAAG,QAAQ,iBAAiB,SAAS,EACrC,GAAG,QAAQ,oBAAoB,UAAU,CAC1C,AACF,GACD,MACD,AACF,EAAC,CACH,AACF,GACD,GAAG,UAAU,MACd,CACF;AAED,SAAO,iBAAiB;GAAC,GAAG,QAAQ,QAAQ;GAAE;GAAa,GAAG,QAAQ,QAAQ;EAAC,GAAE,KAAKA,YAAY;CACnG;AACF","names":["#owner","#outputPath","fileName: string","owner: Plugin"],"sources":["/opt/agent/work/1af72d8adc613024/hilla/packages/ts/generator-plugin-client/src/ClientProcessor.ts"],"sourcesContent":["import type Plugin from '@vaadin/hilla-generator-core/Plugin.js';\nimport createFullyUniqueIdentifier from '@vaadin/hilla-generator-utils/createFullyUniqueIdentifier.js';\nimport createSourceFile from '@vaadin/hilla-generator-utils/createSourceFile.js';\nimport DependencyManager from '@vaadin/hilla-generator-utils/dependencies/DependencyManager.js';\nimport PathManager from '@vaadin/hilla-generator-utils/dependencies/PathManager.js';\nimport ts, { type SourceFile } from 'typescript';\n\nexport default class ClientProcessor {\n  readonly #owner: Plugin;\n  readonly #outputPath: string;\n\n  constructor(fileName: string, owner: Plugin) {\n    this.#outputPath = new PathManager({ extension: 'ts' }).createRelativePath(fileName);\n    this.#owner = owner;\n  }\n\n  process(): SourceFile {\n    this.#owner.logger.debug(`Generating ${this.#outputPath}`);\n\n    const { exports, imports, paths } = new DependencyManager(new PathManager({ extension: '.js' }));\n    const clientClassId = imports.named.add(\n      paths.createBareModulePath('@vaadin/hilla-frontend', false),\n      'ConnectClient',\n    );\n\n    const clientVarId = createFullyUniqueIdentifier('client');\n    exports.default.set(clientVarId);\n\n    const declaration = ts.factory.createVariableStatement(\n      undefined,\n      ts.factory.createVariableDeclarationList(\n        [\n          ts.factory.createVariableDeclaration(\n            clientVarId,\n            undefined,\n            undefined,\n            ts.factory.createNewExpression(clientClassId, undefined, [\n              ts.factory.createObjectLiteralExpression(\n                [\n                  ts.factory.createPropertyAssignment(\n                    ts.factory.createIdentifier('prefix'),\n                    ts.factory.createStringLiteral('connect'),\n                  ),\n                ],\n                false,\n              ),\n            ]),\n          ),\n        ],\n        ts.NodeFlags.Const,\n      ),\n    );\n\n    return createSourceFile([...imports.toCode(), declaration, ...exports.toCode()], this.#outputPath);\n  }\n}\n"],"version":3}